{% extends "base.html" %}

{% block title %}
<h1>{{ place['name'] }}</h1>
    <h5>Tags: 
        {% for tag in place['tags'] %} 
            <a href="/search?tag={{ tag }}">{{ tag }}</a> 
        {% endfor %}
    </h5>
{% endblock %}

{% block content %}
    <div class="row">
        <div class="col-9">
            <h3>Introduction</h3>
            <p>{{ place['intro'] }}</p>
        </div>
        <div class="col-3">
            {% if place['pics'] %}
                <img alt="sample" src="data:image/jpeg;base64,{{ place['pics'][0] }}" width="125">
            {% endif %}
        </div>
    </div>

    <style>
        div.gallery {
          margin: 5px;
          border: 1px solid #ccc;
          float: left;
          height: 250px;
        }

        div.gallery:hover {
          border: 1px solid #777;
        }

        div.gallery img {
          height: 100%;
          width: auto;
        }

        div.desc {
          padding: 15px;
          text-align: center;
        }
    </style>

    {% if place['pics'] %}
        {% for pic in place['pics'] %}
            <div class="gallery">
                <img alt="sample" src="data:image/jpeg;base64,{{ pic }}">
            </div>
        {% endfor %}
    {% endif %}

    {% if place['reviews'] %}
        {% for review in place['reviews'] %}
            <div>
                <p>{{ review }}</p>
            </div>
        {% endfor %}
    {% endif %}

    <div>
        <form method="POST" action="unsubscribe/{{ place['_id'] }}">
            <button id="unsubscribe" hidden=true type="submit">Unsubscribe</button>
        </form>
    </div>
    <div>
        <form method="POST" action="/subscribe/{{ place['_id'] }}">
            <button id="subscribe" hidden=true type="submit">Subscribe</button>
        </form>
    </div>

    <script type="text/javascript">
        var subscribe = document.getElementById("subscribe");
        var unsubscribe = document.getElementById("unsubscribe");
		function with_subscription() {
            subscribe.hidden = true;
            unsubscribe.hidden = false;
            console.log('with')
        }
        function without_subscription() {
            subscribe.hidden = false;
            unsubscribe.hidden = true;
            console.log('without')
        }
        function not_logged_in() {
            subscribe.hidden = true;
            unsubscribe.hidden = true;
            console.log('not logged in')
        }
        
        {% if subscribe_status == 1 %}
            with_subscription();
        {% elif subscribe_status == 0 %}
            without_subscription();
        {% else %}
            not_logged_in();
        {% endif %}
    </script>

{% endblock %}
